<?xml version="1.0"?>

<!--
  UN-OCHA to Haiti AMP reporting template.

  David Megginson, 2010-03-16

  This is a template for an XML document based on an early draft
  schema (2010-03-16) from the International Aid Transparency
  Initiative (IATI).

  All text surrounded by braces ({}) must be filled in.  Most of the
  fields can come directly from the tables in OCHA's database, but any
  text *MUST* be escaped for XML.  Dates and times also must be
  reformatted into ISO format, e.g. 2010-03-14 for a date or
  2010-03-14T13:46:00-04:00 for a date/time.  

  In some cases, it is necessary to compute content (such as the
  project update date) or to substitute values (such as ISO country
  codes).  When elements or attributes should be included or omitted
  based on database values, instructions appear in XML comments (similar
  to this one).

  Note that the template itself is not valid against the schema: it is
  necessary to fill it in before validating, because the schema
  expects certain data types (such as numbers) where this template has
  instructions.
-->

<iati-projects generated-datetime="{datetime generated, e.g. 2010-03-14T12:57:00-04:00}">
  
  <project last-updated-datetime="{datetime project updated, e.g. 2010-03-14T11:00:00+01:00}">

    <primary-id>{FTS.Project_ID}</primary-id>

    <title>{OPS.Project_Title}</title>

    <sector 
        type="DAC" 
        ref="{OPS.Sector_ID}">{optional: name of sector, if available}</sector>

    <description 
        type="summary">{OPS.Project_Summary_Text}</description>

    <description
        type="activities">{OPS.Project_Activities}</description>

    <description
        type="outputs">{OPS.Project_Outputs}</description>

    <description
        type="objectives">{OPS.Objective_Text}</description>

    <start-date-planned>{OPS.Project_Start_Date yyyy-mm-dd}</start-date-planned>

    <completion-date-planned>{OPS.Project_End_Date yyyy-mm-dd}</completion-date-planned>

    <related-initiative 
        type="un-ocha-appeal" 
        ref="{OPS.Appeal_ID}">{optional: name of appeal, if available}</related-initiative>

    <related-initiative 
        type="un-ocha-emergency" 
        ref="{FTS.Emergency_ID}">{optional: name of emergency, if available}</related-initiative>

    <!-- nb: split value and repeat element for each partner -->
    <participating-org 
        role="un-ocha-implementing-partner"
        ref="{OPS.Implementing_Partners}">{optional: partner name, if available}</participating-org>

    <recipient-country
        ref="{OPS.Country_ID mapped to 3-letter ISO code, e.g. HTI}">{optional: country name, if available, e.g. Haiti}</recipient-country>

    <!-- nb: include this next element only if OPS.Project_Pooled is true -->
    <aid-type>pooled</aid-type>

    <target-location 
        type="un-ocha-province"
        ref="{OCHA.Province_ID}">{optional: province name/description, if available, e.g. Dominican Republic}</target-location>

    <sector
        type="cluster" 
        code="{OPS.Project_Grouping_Factor1_ID}">{optional: cluster name/description, if available, e.g. Health}</sector>

    <!-- omit the owner-name attribute if the agency name is unavailable -->
    <other-id
        owner-ref="{OPSOrgs.Organisation_ID}"
        owner-name="{OPSOrgs.Organisation_LongNm}">{OPS.Project_AgencyCode}</other-id>

    <reporting-org 
        ref="{OPSOrgs.Organisation_ID}"
        acronym="{OPSOrgs.Organisation_ShortNm}">{OPSOrgs.Organisation_LongNm}</reporting-org>

    <!-- you always give this in USD, right? if not, need the currency -->
    <total-cost 
        currency="USD">{OPSOrgs.Subtotal_Revised}</total-cost>

    <incoming-contribution 
        ref="{FTS.Contribution_ID}">

      <value currency="{FTS.Original_currency_unit}" 
             usd-equivalent="{FTS.Contribution_Value_USD}"
             usd-conversion-date="{FTS.Decision_Date}">{FTS.Original_currency}</value>

      <status ref="{FTS.Status_ID}">{"committed" or "disbursed" per ID}</status>

      <contribution-type ref="{FTS.Contribution_Type_ID}">{"money" or "in-kind" per ID}</contribution-type>

      <donor-org 
          ref="{FTS.Donor_ID}"
          donor-project-id="{FTS.Donor_project_code}">{optional: donor name, if available}</donor-org>

      <!-- leave this out if the reporting-org is the recipient -->
      <!-- OCHA can probably always leave this out -->
      <recipient-org
          ref="{OCHA identifier for the recipient org}"
          recipient-project-id="{recipient org's id for the project}">{optional: recipient name, if available}</recipient-org>

      <description>{FTS.Contribution_Description}</description>

      <milestone-date
          type="commitment">{FTS.Date_Committed as yyyy-mm-dd}</milestone-date>

      <!-- leave this out if not yet disbursed -->
      <milestone-date
          type="disbursement">{FTS.Date_Disbursed as yyyy-mm-dd}</milestone-date>

    </incoming-contribution>

  </project>

  <!-- repeat the project element for additional projects -->

</iati-projects>